<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Tetris Kids - Fun Block Puzzle Game!</title>
  <meta name="description" content="A colorful and fun Tetris game designed for kids with bright colors and engaging sounds!">
  
  <!-- Mobile-specific meta tags -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#667eea">
  <meta name="msapplication-navbutton-color" content="#667eea">
  <meta name="apple-mobile-web-app-title" content="Tetris Kids">
  
  <!-- Prevent selection and callouts on mobile -->
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/favicon.png">
  
  <!-- Open Graph / Social Media -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Tetris Kids - Fun Block Puzzle Game!">
  <meta property="og:description" content="A colorful and fun Tetris game designed for kids">
  <meta property="og:image" content="/og-image.png">
  
  <!-- Preload critical resources -->
  <link rel="preload" href="/assets/fonts/comic-sans.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- Styles -->
  <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
  <!-- Menu Container -->
  <div id="menuContainer" class="menu-container"></div>

  <!-- Game Container -->
  <div id="app" class="app-container hidden">
    <!-- Header -->
    <header class="game-header">
      <h1 class="game-title">
        üß© Tetris Kids üåà
      </h1>
      <div class="score-container">
        <div class="score-item">
          <span class="score-label">Score:</span>
          <span id="score" class="score-value">0</span>
        </div>
        <div class="score-item">
          <span class="score-label">Level:</span>
          <span id="level" class="score-value">1</span>
        </div>
        <div class="score-item">
          <span class="score-label">Lines:</span>
          <span id="lines" class="score-value">0</span>
        </div>
      </div>
    </header>

    <!-- Main Game Area -->
    <main class="game-main">
      <!-- Game Board -->
      <div class="game-board-container">
        <canvas id="gameCanvas" class="game-canvas" width="320" height="640"></canvas>
        <div id="gameOverlay" class="game-overlay hidden">
          <div class="overlay-content">
            <h2 id="overlayTitle" class="overlay-title">Game Over!</h2>
            <p id="overlayMessage" class="overlay-message">Great job! Try again?</p>
            <div class="overlay-buttons">
              <button id="restartBtn" class="btn btn-primary">Play Again</button>
              <button id="menuBtn" class="btn btn-secondary">Main Menu</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Side Panel -->
      <aside class="game-sidebar">
        <!-- Next Piece Preview -->
        <div class="preview-container">
          <h3 class="preview-title">Next Piece</h3>
          <canvas id="nextPieceCanvas" class="preview-canvas" width="120" height="120"></canvas>
        </div>

        <!-- Game Controls -->
        <div class="controls-container">
          <h3 class="controls-title">Controls</h3>
          <div class="control-buttons">
            <button id="pauseBtn" class="btn btn-game">‚è∏Ô∏è Pause</button>
            <button id="muteBtn" class="btn btn-game">üîä Sound</button>
          </div>
          
          <!-- Touch Controls for Mobile -->
          <div class="touch-controls">
            <div class="touch-row">
              <button id="rotateBtn" class="btn btn-touch">‚Üª</button>
            </div>
            <div class="touch-row">
              <button id="leftBtn" class="btn btn-touch">‚Üê</button>
              <button id="downBtn" class="btn btn-touch">‚Üì</button>
              <button id="rightBtn" class="btn btn-touch">‚Üí</button>
            </div>
            <div class="touch-row">
              <button id="dropBtn" class="btn btn-touch">‚áì</button>
            </div>
          </div>
        </div>

        <!-- Instructions -->
        <div class="instructions-container">
          <h3 class="instructions-title">How to Play</h3>
          <ul class="instructions-list">
            <li>Use arrow keys to move blocks</li>
            <li>Press UP arrow to rotate</li>
            <li>Complete rows to score points</li>
            <li>Don't let blocks reach the top!</li>
          </ul>
        </div>
      </aside>
    </main>

    <!-- Footer -->
    <footer class="game-footer">
      <p class="footer-text">Made with ‚ù§Ô∏è for kids everywhere!</p>
    </footer>
  </div>

  <!-- Loading Screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading your awesome game...</p>
    </div>
  </div>

  <!-- Debug info for mobile troubleshooting -->
  <div id="debugInfo" style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.8); color: white; padding: 10px; font-size: 12px; z-index: 10000; display: none; max-width: 300px; border-radius: 5px;">
    <div id="debugContent">Loading debug info...</div>
    <button onclick="document.getElementById('debugInfo').style.display='none'" style="margin-top: 5px;">Close</button>
  </div>

  <!-- Main JavaScript -->
  <script type="module" src="src/main.js"></script>
  
  <!-- Debug script for mobile -->
  <script>
    // Show debug info on triple-tap
    let tapCount = 0;
    let tapTimeout;
    
    document.addEventListener('touchstart', function(e) {
      tapCount++;
      clearTimeout(tapTimeout);
      
      if (tapCount === 3) {
        showDebugInfo();
        tapCount = 0;
      } else {
        tapTimeout = setTimeout(() => {
          tapCount = 0;
        }, 1000);
      }
    });
    
    // Also show on Ctrl+D
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key === 'd') {
        e.preventDefault();
        showDebugInfo();
      }
    });
    
    function showDebugInfo() {
      const debugDiv = document.getElementById('debugInfo');
      const debugContent = document.getElementById('debugContent');
      
      const touchControls = document.querySelector('.touch-controls');
      const gameCanvas = document.getElementById('gameCanvas');
      
      const info = {
        'Screen Size': `${window.innerWidth} x ${window.innerHeight}`,
        'Device Pixel Ratio': window.devicePixelRatio,
        'Touch Support': 'ontouchstart' in window,
        'Max Touch Points': navigator.maxTouchPoints,
        'User Agent': navigator.userAgent.substring(0, 50) + '...',
        'Touch Controls Found': !!touchControls,
        'Touch Controls Display': touchControls ? getComputedStyle(touchControls).display : 'N/A',
        'Touch Controls Visible': touchControls ? !touchControls.classList.contains('hidden') : 'N/A',
        'Game Canvas Found': !!gameCanvas,
        'Canvas Dimensions': gameCanvas ? `${gameCanvas.width} x ${gameCanvas.height}` : 'N/A',
        'Canvas Style Size': gameCanvas ? `${gameCanvas.style.width} x ${gameCanvas.style.height}` : 'N/A',
        'Canvas Client Size': gameCanvas ? `${gameCanvas.clientWidth} x ${gameCanvas.clientHeight}` : 'N/A'
      };
      
      debugContent.innerHTML = Object.entries(info)
        .map(([key, value]) => `<strong>${key}:</strong> ${value}`)
        .join('<br>');
      
      debugDiv.style.display = 'block';
    }
    
    console.log('Debug utilities loaded. Triple-tap screen or press Ctrl+D to show debug info.');
  </script>
</body>
</html>